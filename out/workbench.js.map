{"version":3,"file":"workbench.js","sources":["../src/workbench/keys.ts","../src/workbench/shared.ts","../src/workbench/lifecycle.ts","../src/workbench/regexToDomToCss.ts","../src/workbench/syntax.ts","../src/workbench/highlight.ts","../src/workbench/index.ts"],"sourcesContent":["export const extensionId = 'kauderk.concise-syntax'\r\nexport const windowId = 'window.' + extensionId\r\n// exploit the fact that vscode renders data to the dom, could be any other attribute\r\nexport const bridgeBetweenVscodeExtension = 'aria-label'\r\nexport const customCSS = `\r\n\t.view-lines {\r\n\t\t--r: transparent;\r\n\t}\r\n\t.view-lines:has(.dummy:hover) {\r\n\t\t--r: red;\r\n\t}\r\n\t.dummy {\r\n\t\tcolor: var(--r);\r\n\t}\r\n\t`\r\n\r\nexport const idSelector = '[data-mode-id=\"typescriptreact\"]'\r\nexport const linesSelector =\r\n  idSelector + ` .view-lines.monaco-mouse-cursor-text`\r\nexport const highlightSelector = idSelector + ` .view-overlays`\r\nexport const languages = ['typescriptreact', 'javascriptreact']\r\n","import { windowId } from './keys'\r\n\r\nexport const stylesContainer =\r\n  document.getElementById(windowId) ?? document.createElement('div')\r\nstylesContainer.id = windowId\r\ndocument.body.appendChild(stylesContainer)\r\n\r\nexport function createStyles(name: string) {\r\n  const id = windowId + '.' + name\r\n  const style =\r\n    stylesContainer.querySelector(`[id=\"${id}\"]`) ??\r\n    document.createElement('style')\r\n  style.id = id\r\n  stylesContainer.appendChild(style)\r\n\r\n  return {\r\n    element: style,\r\n    styleIt: (text: string) => styleIt(style, text),\r\n    dispose() {\r\n      style.textContent = ''\r\n    },\r\n  }\r\n}\r\n\r\nexport function styleIt(style: Element, text: string) {\r\n  return (style.textContent = text\r\n    .replace(/\\r|\\n/g, '')\r\n    .replaceAll(/\\t+/g, '\\n'))\r\n}\r\n\r\nexport type MutationOptions = {\r\n  added(node: HTMLElement): void\r\n  removed(node: HTMLElement): void\r\n  usingUnobservable?: boolean\r\n}\r\nexport function createMutation<M extends MutationOptions>(option: M) {\r\n  const mutationObserver = option.usingUnobservable\r\n    ? MutationUnObserver\r\n    : MutationObserver\r\n  return new mutationObserver((mutations) => {\r\n    mutations.forEach((mutation) => {\r\n      mutation.addedNodes.forEach((node: any) => option.added(node))\r\n      mutation.removedNodes.forEach((node: any) => option.removed(node))\r\n    })\r\n    // typescript should infer this, right?\r\n  }) as M['usingUnobservable'] extends true\r\n    ? MutationUnObserver\r\n    : MutationObserver\r\n}\r\n\r\ntype D = string | undefined\r\ntype Bridge = {\r\n  target: HTMLElement\r\n  attribute: D\r\n}\r\nexport function createAttributeMutation(props: {\r\n  watchAttribute: string\r\n  activate: (payload: D) => void\r\n  inactive: (payload: D) => void\r\n}) {\r\n  let previousData: D\r\n  const bridgeAttribute = (target: any): D =>\r\n    target?.getAttribute?.(props.watchAttribute)\r\n\r\n  const observer = new MutationObserver((mutations) => {\r\n    for (const mutation of mutations) {\r\n      const newData = bridgeAttribute(mutation.target)\r\n      if (previousData === newData) return\r\n      previousData = newData\r\n\r\n      if (newData) {\r\n        props.activate(newData)\r\n      } else {\r\n        props.inactive(newData)\r\n      }\r\n    }\r\n  })\r\n\r\n  let freezeTarget: HTMLElement\r\n  return {\r\n    activate(target: HTMLElement) {\r\n      freezeTarget = target // this is annoying\r\n      previousData = bridgeAttribute(target)\r\n\r\n      props.activate(previousData)\r\n      observer.observe(target, {\r\n        attributes: true,\r\n        attributeFilter: [props.watchAttribute],\r\n      })\r\n    },\r\n    dispose() {\r\n      // lol this could be a problem\r\n      props.inactive(previousData)\r\n      observer.disconnect()\r\n    },\r\n  }\r\n}\r\n\r\n// TODO: test if this is more \"performant\" or just mental gymnastics\r\nexport function watchForRemoval(targetElement: Element, callback: Function) {\r\n  let done = false\r\n  let stack: Node[] = []\r\n  const rootObserver = new MutationObserver((mutationsList) => {\r\n    mutationsList.forEach((mutation) => {\r\n      if (\r\n        done ||\r\n        !stack.includes(mutation.target) ||\r\n        !mutation.removedNodes.length\r\n      )\r\n        return\r\n\r\n      const nodes = Array.from(mutation.removedNodes)\r\n      // console.log(mutation.target)\r\n\r\n      // direct match\r\n      if (\r\n        nodes.indexOf(targetElement) > -1 ||\r\n        // parent match\r\n        nodes.some((parent) => parent.contains(targetElement))\r\n      ) {\r\n        debugger\r\n        dispose()\r\n        callback()\r\n        return\r\n      }\r\n    })\r\n  })\r\n\r\n  function REC_ObserverAncestors(element: Element) {\r\n    if (!element.parentElement || element.parentElement === document.body) {\r\n      return\r\n    }\r\n    stack.push(element.parentElement)\r\n    rootObserver.observe(element.parentElement, { childList: true })\r\n    REC_ObserverAncestors(element.parentElement)\r\n  }\r\n\r\n  // Start observing ancestor hierarchy\r\n  REC_ObserverAncestors(targetElement)\r\n\r\n  function dispose() {\r\n    done = true\r\n    stack = []\r\n    rootObserver.takeRecords()\r\n    rootObserver.disconnect()\r\n  }\r\n  return dispose\r\n}\r\n\r\n// https://github.com/whatwg/dom/issues/126#issuecomment-1049814948\r\nclass MutationUnObserver extends MutationObserver {\r\n  private observerTargets: Array<{\r\n    target: Node\r\n    options?: MutationObserverInit\r\n  }> = []\r\n\r\n  observe(target: Node, options?: MutationObserverInit): void {\r\n    this.observerTargets.push({ target, options })\r\n\r\n    return super.observe(target, options)\r\n  }\r\n\r\n  unobserve(target: Node): void {\r\n    const newObserverTargets = this.observerTargets.filter(\r\n      (ot) => ot.target !== target\r\n    )\r\n    this.observerTargets = []\r\n    this.disconnect()\r\n    newObserverTargets.forEach((ot) => {\r\n      this.observe(ot.target, ot.options)\r\n    })\r\n  }\r\n}\r\n","import { watchForRemoval } from './shared'\r\n\r\nexport type LifecycleProps<T> = {\r\n  activate(dom: T): void | (() => void)\r\n  dom(): T & { check(): boolean; watchForRemoval: HTMLElement }\r\n  dispose?: () => void\r\n}\r\n\r\n/**\r\n * @description The **activate** function is called when the dom **check** passes. Then if the **item** is removed from the dom, the **dispose** function is called.\r\n *\r\n * Then it will try to **reload** the lifecycle.\r\n */\r\nexport function lifecycle<T>(props: LifecycleProps<T>) {\r\n  let running = false\r\n  let anyUsage = false\r\n  let interval: NodeJS.Timeout\r\n  let disposeObserver = () => {}\r\n  let disposeActivate: Function | void\r\n\r\n  function patch() {\r\n    const dom = props.dom()\r\n    if (running || !dom.check()) return\r\n    anyUsage = true\r\n    running = true\r\n    clearInterval(interval)\r\n    disposeObserver = watchForRemoval(dom.watchForRemoval, reload)\r\n    disposeActivate = props.activate(dom)\r\n  }\r\n  function dispose() {\r\n    disposeActivate?.()\r\n    disposeObserver()\r\n    props.dispose?.()\r\n    running = false\r\n    clearInterval(interval)\r\n  }\r\n  function reload() {\r\n    dispose()\r\n    interval = setInterval(patch, 5000)\r\n  }\r\n\r\n  let exhaust: any\r\n\r\n  return {\r\n    activate() {\r\n      reload()\r\n      exhaust = setTimeout(() => {\r\n        clearTimeout(exhaust)\r\n        if (!anyUsage) {\r\n          clearInterval(interval)\r\n        }\r\n      }, 1000 * 60 * 2)\r\n    },\r\n    dispose() {\r\n      dispose()\r\n      clearTimeout(exhaust)\r\n      clearInterval(interval)\r\n    },\r\n  }\r\n}\r\n","import { linesSelector, customCSS } from './keys'\r\n\r\nexport function regexToDomToCss() {\r\n  const lineEditor = document.querySelector(linesSelector)\r\n  if (!lineEditor) {\r\n    console.log('Fail to find Editor with selector:', linesSelector)\r\n    return ''\r\n  }\r\n  type Flag = {\r\n    hide: string\r\n    hover: string\r\n  }\r\n  type Flags = null | Flag\r\n  const flags = {\r\n    jsxTag: null as Flags,\r\n    jsxTernaryBrace: null as Flags,\r\n    jsxTernaryOtherwise: null as Flags,\r\n    vsCodeHiddenTokens: null as Flags,\r\n    beginQuote: null as Flags,\r\n    endQuote: null as Flags,\r\n  }\r\n  const customFlags = {\r\n    singleQuotes: null as string | null,\r\n  }\r\n\r\n  const root = `${linesSelector}>div>span`\r\n  const lines = Array.from(lineEditor.querySelectorAll('div>span'))\r\n\r\n  function toFlatClassList<T extends { join: (to?: string) => string }>(\r\n    Array: T[]\r\n  ) {\r\n    return Array.reduce(\r\n      (acc, val) => acc.concat(val.join('.')),\r\n      <string[]>[]\r\n    ) as string[] // FIXME: avoid casting\r\n  }\r\n  function SliceClassList(line: Element, slice: number) {\r\n    const sliced = Array.from(line.children)\r\n      .slice(slice)\r\n      .map((c) => Array.from(c.classList))\r\n    return Object.assign(sliced, { okLength: sliced.length == slice * -1 })\r\n  }\r\n\r\n  parser: for (const line of lines) {\r\n    const text = line.textContent\r\n    if (!text) continue\r\n    let anyFlag = false\r\n\r\n    if (text.match('.+(</(?<jsxTag>.*)?>)$')?.groups?.jsxTag) {\r\n      if (flags.jsxTag || flags.vsCodeHiddenTokens) continue\r\n\r\n      const closing = SliceClassList(line, -3)\r\n      if (!closing.okLength) continue\r\n      const [angleBracket, tag, right] = closing.flat()\r\n      if (angleBracket !== right) continue\r\n\r\n      flags.jsxTag = {\r\n        // find the last </tag> and hide it \"tag\" which is the second to last child\r\n        hide: `:has(:nth-last-child(3).${angleBracket}+.${tag}+.${angleBracket}) :nth-last-child(2)`,\r\n        hover: `.${angleBracket}+.${tag}`,\r\n      }\r\n      flags.vsCodeHiddenTokens = {\r\n        // this is the most common case, you could derive it from other flags\r\n        hide: `>.${angleBracket}`,\r\n        hover: `.${angleBracket}`,\r\n      }\r\n\r\n      anyFlag = true\r\n    } else if (\r\n      text.match(/(\\{).+\\?.+?(?<ternaryBrace>\\()$/)?.groups?.ternaryBrace\r\n    ) {\r\n      if (flags.jsxTernaryBrace) continue\r\n\r\n      const closing = SliceClassList(line, -4)\r\n      if (!closing.okLength) continue\r\n      // prettier-ignore\r\n      const [blank, questionMark, blank2, openBrace] = toFlatClassList(closing)\r\n      const selector = `.${blank}+.${questionMark}+.${blank}+.${openBrace}:last-child`\r\n\r\n      flags.jsxTernaryBrace = {\r\n        // find the last open brace in \" ? (\"\r\n        hide: `:has(${selector}) :last-child`,\r\n        hover: selector,\r\n      }\r\n\r\n      anyFlag = true\r\n    } else if (\r\n      text.match(/(?<ternaryOtherwise>\\).+?:.+\\})/)?.groups?.ternaryOtherwise\r\n    ) {\r\n      if (flags.jsxTernaryOtherwise) continue\r\n\r\n      const closing = SliceClassList(line, -7)\r\n      if (!closing.okLength) continue\r\n      // prettier-ignore\r\n      const [blank0, closeBrace, blank, colon, blank2, nullIsh,closeBracket] = toFlatClassList(closing)\r\n      const selector = `.${blank0}+.${closeBrace}+.${blank}+.${colon}+.${blank2}+.${nullIsh}+.${closeBracket}:last-child`\r\n\r\n      flags.jsxTernaryOtherwise = {\r\n        // find \") : null}\" then hide it all\r\n        hide: `:has(${selector}) *`,\r\n        hover: selector,\r\n      }\r\n\r\n      anyFlag = true\r\n    } else if (text.match(/(?<singleQuotes>\"\"|''|``)/)?.groups?.singleQuotes) {\r\n      // FIXME: what if there are no empty quotes/strings?\r\n      if (customFlags.singleQuotes) continue\r\n\r\n      const array = Array.from(line.children)\r\n      const quote = /\"|'|`/\r\n      singleQuotes: for (let i = 0; i < array.length; i++) {\r\n        const child = array[i]\r\n\r\n        const current = child.textContent?.match(quote)\r\n        const next = array[i + 1]?.textContent?.match(quote)\r\n        if (current?.[0].length == 1 && current[0] === next?.[0]) {\r\n          const beginQuote = Array.from(child.classList).join('.')\r\n          const endQuote = Array.from(array[i + 1].classList).join('.') // wow, why isn't typescript freaking out?\r\n\r\n          // Find \"\" or '' or `` and show them\r\n          customFlags.singleQuotes = `.${beginQuote}:has(+.${endQuote}), .${beginQuote}+.${endQuote} {\r\n\t\t\t\t\t\t\tcolor: gray;\r\n\t\t\t\t\t\t}`\r\n          flags.beginQuote = {\r\n            // this is the most common case, you could derive it from other flags\r\n            hide: `>.${beginQuote}`,\r\n            hover: `.${beginQuote}`,\r\n          }\r\n          flags.endQuote = {\r\n            // this is the most common case, you could derive it from other flags\r\n            hide: `>.${endQuote}`,\r\n            hover: `.${endQuote}`,\r\n          }\r\n\r\n          anyFlag = true\r\n          break singleQuotes\r\n        }\r\n      }\r\n    }\r\n\r\n    if (\r\n      anyFlag &&\r\n      Object.values(flags).every((f) => !!f) &&\r\n      Object.values(customFlags).every((f) => !!f)\r\n    ) {\r\n      break parser\r\n    }\r\n  }\r\n  // you know the concise syntax hover feature will work because you found the common case\r\n  const validFlags = Object.values(flags).filter(\r\n    (f) => f?.hide && f.hover\r\n  ) as Flag[] // FIXME: avoid casting\r\n  if (validFlags.length && flags.vsCodeHiddenTokens?.hover) {\r\n    const toHover = validFlags.map((f) => f.hover).join(',')\r\n    const toHidden = validFlags.map((f) => root + f.hide).join(',')\r\n    const toCustom = Object.values(customFlags)\r\n      .filter((f) => !!f)\r\n      .join('\\n')\r\n    return `\r\n\t\t\t.view-lines {\r\n\t\t\t\t--r: transparent;\r\n\t\t\t}\r\n\t\t\t.view-lines > div:hover {\r\n\t\t\t\t--r: yellow;\r\n\t\t\t}\r\n\t\t\t.view-lines:has(:is(${toHover}):hover) {\r\n\t\t\t\t--r: red;\r\n\t\t\t}\r\n\t\t\t${toHidden} {\r\n\t\t\t\tcolor: var(--r);\r\n\t\t\t}\r\n\t\t\t${toCustom}\r\n\t\t\t`\r\n      .replace(/\\r|\\n/g, '')\r\n      .replaceAll(/\\t+/g, '\\n')\r\n  }\r\n  // FIXME: honestly, the user should get a warning: the extension can't find the common case\r\n  return ''\r\n}\r\n","import { bridgeBetweenVscodeExtension, extensionId } from './keys'\r\nimport { lifecycle } from './lifecycle'\r\nimport { regexToDomToCss } from './regexToDomToCss'\r\nimport { createAttributeMutation, createStyles } from './shared'\r\n\r\nfunction domExtension() {\r\n  const statusBar = document.querySelector('.right-items') as HTMLElement\r\n  const item = statusBar?.querySelector(`[id=\"${extensionId}\"]`) as HTMLElement\r\n  const icon = item?.querySelector('.codicon') as HTMLElement\r\n  return { icon, item, statusBar }\r\n}\r\nconst bridgeAttribute = (target: any) =>\r\n  // You could pass stringified data\r\n  !target.getAttribute?.(bridgeBetweenVscodeExtension)?.includes('inactive')\r\n\r\n/**\r\n * @description When the vscode extension changes the \"bridge attribute\" apply custom styles\r\n *\r\n * Take a look at: regexToDomToCss.ts to see how the styles are generated\r\n */\r\nexport function createSyntaxLifecycle() {\r\n  let Extension: null | Extension\r\n  const syntaxStyle = createStyles('hide')\r\n\r\n  function activate(extension: Extension) {\r\n    Extension = extension // alright...\r\n    const on = bridgeAttribute(extension.item)\r\n\r\n    extension.icon.style.fontWeight = on ? 'bold' : 'normal'\r\n    const title = 'Concise Syntax'\r\n    extension.item.title = on ? `${title}: active` : `${title}: inactive`\r\n    syntaxStyle.styleIt(on ? regexToDomToCss() : '')\r\n  }\r\n  function inactive() {\r\n    if (!Extension) return\r\n    Extension.item.removeAttribute('title')\r\n    Extension.icon.style.removeProperty('font-weight')\r\n  }\r\n\r\n  const attributeObserver = createAttributeMutation({\r\n    watchAttribute: bridgeBetweenVscodeExtension,\r\n    activate() {\r\n      activate(domExtension())\r\n    },\r\n    inactive() {\r\n      inactive()\r\n    },\r\n  })\r\n\r\n  const cycle = lifecycle<Extension>({\r\n    dom() {\r\n      const dom = domExtension()\r\n      return {\r\n        ...dom,\r\n        watchForRemoval: dom.item,\r\n        check() {\r\n          return !!(document.contains(dom.statusBar?.parentNode) && dom.icon)\r\n        },\r\n      }\r\n    },\r\n    activate(dom) {\r\n      attributeObserver.activate(dom.item)\r\n    },\r\n    dispose() {\r\n      attributeObserver.dispose()\r\n      syntaxStyle.dispose()\r\n    },\r\n  })\r\n\r\n  return cycle\r\n}\r\ntype Extension = ReturnType<typeof domExtension>\r\n","import { highlightSelector, idSelector, linesSelector, windowId } from './keys'\r\nimport { lifecycle } from './lifecycle'\r\nimport {\r\n  MutationOptions,\r\n  createAttributeMutation,\r\n  createMutation,\r\n  styleIt,\r\n  stylesContainer,\r\n} from './shared'\r\n\r\n/**\r\n * @description Change color of highlighted or selected lines\r\n *\r\n * Read this function from bottom to top\r\n *\r\n * At the bottom is the lifecycle function\r\n *\r\n * At the top is main function: createHighlight\r\n */\r\nexport function createHighlightLifeCycle() {\r\n  function createHighlight({ node, selector, add, set, color }: Selected) {\r\n    if (!node.querySelector(selector)) return\r\n    // @ts-ignore\r\n    const old = node.editor\r\n    const label =\r\n      node.closest('[aria-label][data-mode-id]')?.getAttribute('aria-label') ??\r\n      old\r\n    // @ts-ignore\r\n    node.editor = label\r\n\r\n    const top = Number(node.style?.top.match(/\\d+/)?.[0])\r\n    if (\r\n      isNaN(top) ||\r\n      set.has(top) === add ||\r\n      (!add &&\r\n        // most likely a node previous the lifecycle\r\n        (!label ||\r\n          // FIXME: figure out how to overcome vscode rapid dom swap at viewLayers.ts _finishRenderingInvalidLines\r\n          document.querySelector(\r\n            highlightSelector + `>[style*=\"${top}\"]>` + selector\r\n          )))\r\n    ) {\r\n      return\r\n    }\r\n\r\n    if (!add && !label) {\r\n      return console.warn('no group', node, top)\r\n    }\r\n\r\n    // funny code\r\n    set[add ? 'add' : 'delete'](top)\r\n\r\n    const lines = Array.from(set)\r\n      .reduce((acc, top) => acc + `[style*=\"${top}\"],`, '')\r\n      .slice(0, -1)\r\n\r\n    const uid = (label ?? windowId) + selector\r\n    let style = stylesContainer.querySelector(\r\n      `[aria-label=\"${uid}\"]`\r\n    ) as HTMLElement\r\n    if (!style || !stylesContainer.contains(style)) {\r\n      style = document.createElement('style')\r\n      style.dataset.label = uid\r\n      stylesContainer.appendChild(style)\r\n    }\r\n\r\n    styleIt(\r\n      style,\r\n      `[aria-label=\"${label}\"]${linesSelector} :is(${lines}) {\r\n\t\t\t\t\t--r: ${color};\r\n\t\t\t}`\r\n    )\r\n\r\n    return true\r\n  }\r\n\r\n  let selectedLines = new Set<number>()\r\n  const selectedSelector = '.selected-text'\r\n\r\n  let currentLines = new Set<number>()\r\n  const currentLineSelector = '.current-line'\r\n\r\n  function highlightStyles(node: HTMLElement, add: boolean) {\r\n    createHighlight({\r\n      node,\r\n      selector: selectedSelector,\r\n      add,\r\n      set: selectedLines,\r\n      color: 'orange',\r\n    }) ||\r\n      createHighlight({\r\n        node,\r\n        selector: currentLineSelector,\r\n        add,\r\n        set: currentLines,\r\n        color: 'brown',\r\n      })\r\n  }\r\n  const Highlight = {\r\n    added(node) {\r\n      highlightStyles(node, true)\r\n    },\r\n    removed(node) {\r\n      highlightStyles(node, false)\r\n    },\r\n  } satisfies MutationOptions\r\n\r\n  const EditorOverlayMap = new Map<Element, { dispose(): void }>()\r\n  const EditorOverlay = {\r\n    usingUnobservable: true,\r\n    added(editor) {\r\n      const overlays = editor.querySelector?.(highlightSelector)\r\n      if (!overlays) return\r\n      const languageObserver = createAttributeMutation({\r\n        watchAttribute: 'data-mode-id',\r\n        activate(language) {\r\n          if (!language) return // hydrating...\r\n          highlightObserver.disconnect()\r\n          if (language === 'typescriptreact') {\r\n            const overlays = editor.querySelector?.(highlightSelector)\r\n            if (!overlays) return console.warn('no overlays')\r\n            console.log('overlays', arguments)\r\n            highlightObserver.observe(overlays, {\r\n              childList: true,\r\n            })\r\n          }\r\n        },\r\n        inactive(language) {\r\n          console.log('inactive', arguments)\r\n          highlightObserver.disconnect()\r\n        },\r\n      })\r\n      const groupObserver = createAttributeMutation({\r\n        watchAttribute: 'aria-label',\r\n        activate(label) {\r\n          console.log('activate', arguments)\r\n          stylesContainer\r\n            .querySelectorAll(`[aria-label=\"${label}\"]`)\r\n            .forEach((style) => style.remove())\r\n        },\r\n        inactive(label) {\r\n          console.log('inactive', arguments)\r\n          stylesContainer\r\n            .querySelectorAll(`[aria-label=\"${label}\"]`)\r\n            .forEach((style) => style.remove())\r\n        },\r\n      })\r\n      const highlightObserver = createMutation(Highlight)\r\n\r\n      EditorOverlayMap.get(editor)?.dispose()\r\n      languageObserver.activate(editor)\r\n      groupObserver.activate(editor)\r\n      EditorOverlayMap.set(editor, {\r\n        dispose() {\r\n          highlightObserver.disconnect()\r\n          languageObserver.dispose()\r\n          groupObserver.dispose()\r\n        },\r\n      })\r\n    },\r\n    removed(editor) {\r\n      if (!editor.querySelector?.(highlightSelector)) return\r\n\r\n      EditorOverlayMap.get(editor)?.dispose()\r\n      EditorOverlayMap.delete(editor)\r\n    },\r\n  } satisfies MutationOptions\r\n  const EditorOverlayDeployer = createMutation(EditorOverlay)\r\n\r\n  const cycle = lifecycle({\r\n    dom() {\r\n      const root = document.querySelector(\r\n        '#workbench\\\\.parts\\\\.editor > div.content > div > div > div > div > div.monaco-scrollable-element > div.split-view-container'\r\n      ) as HTMLElement\r\n      const editor = root?.querySelector(idSelector) as HTMLElement\r\n      const overlays = editor?.querySelector(highlightSelector)\r\n        ?.parentElement as HTMLElement\r\n      return {\r\n        check() {\r\n          return !!(root && editor && overlays)\r\n        },\r\n        watchForRemoval: root,\r\n      }\r\n    },\r\n    activate(dom) {\r\n      /**\r\n       * - split-view-container\r\n       * \t\t- split-view-view -> Recursion\r\n       * \t\t\t- editor-container\r\n       */\r\n      let editorContainersMap = new Set<HTMLElement>()\r\n      const rootContainerObserver = createMutation({\r\n        added(node) {\r\n          const editorContainers = Array.from(\r\n            node.querySelectorAll('.editor-container')\r\n          )\r\n          editorContainers.forEach((node: any) => {\r\n            if (!editorContainersMap.has(node)) {\r\n              debugger\r\n              EditorOverlay.added(node)\r\n              EditorOverlayDeployer.observe(node, {\r\n                childList: true,\r\n              })\r\n            } else {\r\n              editorContainersMap.add(node)\r\n            }\r\n          })\r\n        },\r\n        removed(node) {\r\n          const editorContainers = Array.from(\r\n            node.querySelectorAll('.editor-container')\r\n          )\r\n          editorContainers.forEach((node: any) => {\r\n            if (editorContainersMap.has(node)) {\r\n              debugger\r\n              EditorOverlay.removed(node)\r\n              EditorOverlayDeployer.disconnect()\r\n              editorContainersMap.delete(node)\r\n            }\r\n          })\r\n        },\r\n      })\r\n      rootContainerObserver.observe(dom.watchForRemoval, {\r\n        childList: true,\r\n        subtree: true,\r\n      })\r\n      return () => rootContainerObserver.disconnect()\r\n    },\r\n    dispose() {\r\n      Object.values(EditorOverlayMap).forEach((observer) => observer.dispose())\r\n      EditorOverlayMap.clear()\r\n      EditorOverlayDeployer.disconnect()\r\n      selectedLines.clear()\r\n      currentLines.clear()\r\n      stylesContainer\r\n        .querySelectorAll('[aria-label]')\r\n        .forEach((style) => style.remove())\r\n      stylesContainer.querySelectorAll('style').forEach((style) => {\r\n        style.textContent = ''\r\n      })\r\n    },\r\n  })\r\n\r\n  return cycle\r\n}\r\n\r\ntype Selected = {\r\n  node: HTMLElement\r\n  selector: string\r\n  add: boolean\r\n  set: Set<number>\r\n  color: string\r\n}\r\n","import { createSyntaxLifecycle } from './syntax'\r\nimport { createHighlightLifeCycle } from './highlight'\r\nimport { extensionId } from './keys'\r\n\r\nconst syntax = createSyntaxLifecycle()\r\nconst highlight = createHighlightLifeCycle()\r\n\r\nconst conciseSyntax = {\r\n  activate() {\r\n    syntax.activate()\r\n    highlight.activate()\r\n  },\r\n  dispose() {\r\n    syntax.dispose()\r\n    highlight.dispose()\r\n  },\r\n}\r\n\r\n// @ts-ignore\r\nif (window.conciseSyntax) {\r\n  // @ts-ignore\r\n  window.conciseSyntax.dispose()\r\n}\r\n// @ts-ignore\r\nwindow.conciseSyntax = conciseSyntax\r\nconciseSyntax.activate()\r\n\r\nconsole.log(extensionId, conciseSyntax)\r\n"],"names":["bridgeAttribute","Array","top","overlays","_a","node"],"mappings":";;;;;;;;;;AAAO,QAAM,cAAc;AACpB,QAAM,WAAW,YAAY;AAE7B,QAAM,+BAA+B;AAarC,QAAM,aAAa;AACnB,QAAM,gBACX,aAAa;AACR,QAAM,oBAAoB,aAAa;ACjBvC,QAAM,kBACX,SAAS,eAAe,QAAQ,KAAK,SAAS,cAAc,KAAK;AACnE,kBAAgB,KAAK;AACrB,WAAS,KAAK,YAAY,eAAe;AAElC,WAAS,aAAa,MAAc;AACnC,UAAA,KAAK,WAAW,MAAM;AACtB,UAAA,QACJ,gBAAgB,cAAc,QAAQ,EAAE,IAAI,KAC5C,SAAS,cAAc,OAAO;AAChC,UAAM,KAAK;AACX,oBAAgB,YAAY,KAAK;AAE1B,WAAA;AAAA,MACL,SAAS;AAAA,MACT,SAAS,CAAC,SAAiB,QAAQ,OAAO,IAAI;AAAA,MAC9C,UAAU;AACR,cAAM,cAAc;AAAA,MACtB;AAAA,IAAA;AAAA,EAEJ;AAEgB,WAAA,QAAQ,OAAgB,MAAc;AAC5C,WAAA,MAAM,cAAc,KACzB,QAAQ,UAAU,EAAE,EACpB,WAAW,QAAQ,IAAI;AAAA,EAC5B;AAOO,WAAS,eAA0C,QAAW;AAC7D,UAAA,mBAAmB,OAAO,oBAC5B,qBACA;AACG,WAAA,IAAI,iBAAiB,CAAC,cAAc;AAC/B,gBAAA,QAAQ,CAAC,aAAa;AAC9B,iBAAS,WAAW,QAAQ,CAAC,SAAc,OAAO,MAAM,IAAI,CAAC;AAC7D,iBAAS,aAAa,QAAQ,CAAC,SAAc,OAAO,QAAQ,IAAI,CAAC;AAAA,MAAA,CAClE;AAAA,IAAA,CAEF;AAAA,EAGH;AAOO,WAAS,wBAAwB,OAIrC;AACG,QAAA;AACJ,UAAMA,mBAAkB,CAAC,WACvB;;AAAA,oDAAQ,iBAAR,gCAAuB,MAAM;AAAA;AAE/B,UAAM,WAAW,IAAI,iBAAiB,CAAC,cAAc;AACnD,iBAAW,YAAY,WAAW;AAC1B,cAAA,UAAUA,iBAAgB,SAAS,MAAM;AAC/C,YAAI,iBAAiB;AAAS;AACf,uBAAA;AAEf,YAAI,SAAS;AACX,gBAAM,SAAS,OAAO;AAAA,QAAA,OACjB;AACL,gBAAM,SAAS,OAAO;AAAA,QACxB;AAAA,MACF;AAAA,IAAA,CACD;AAGM,WAAA;AAAA,MACL,SAAS,QAAqB;AAE5B,uBAAeA,iBAAgB,MAAM;AAErC,cAAM,SAAS,YAAY;AAC3B,iBAAS,QAAQ,QAAQ;AAAA,UACvB,YAAY;AAAA,UACZ,iBAAiB,CAAC,MAAM,cAAc;AAAA,QAAA,CACvC;AAAA,MACH;AAAA,MACA,UAAU;AAER,cAAM,SAAS,YAAY;AAC3B,iBAAS,WAAW;AAAA,MACtB;AAAA,IAAA;AAAA,EAEJ;AAGgB,WAAA,gBAAgB,eAAwB,UAAoB;AAC1E,QAAI,OAAO;AACX,QAAI,QAAgB,CAAA;AACpB,UAAM,eAAe,IAAI,iBAAiB,CAAC,kBAAkB;AAC7C,oBAAA,QAAQ,CAAC,aAAa;AAEhC,YAAA,QACA,CAAC,MAAM,SAAS,SAAS,MAAM,KAC/B,CAAC,SAAS,aAAa;AAEvB;AAEF,cAAM,QAAQ,MAAM,KAAK,SAAS,YAAY;AAK5C,YAAA,MAAM,QAAQ,aAAa,IAAI;AAAA,QAE/B,MAAM,KAAK,CAAC,WAAW,OAAO,SAAS,aAAa,CAAC,GACrD;AACA;AACQ;AACC;AACT;AAAA,QACF;AAAA,MAAA,CACD;AAAA,IAAA,CACF;AAED,aAAS,sBAAsB,SAAkB;AAC/C,UAAI,CAAC,QAAQ,iBAAiB,QAAQ,kBAAkB,SAAS,MAAM;AACrE;AAAA,MACF;AACM,YAAA,KAAK,QAAQ,aAAa;AAChC,mBAAa,QAAQ,QAAQ,eAAe,EAAE,WAAW,MAAM;AAC/D,4BAAsB,QAAQ,aAAa;AAAA,IAC7C;AAGA,0BAAsB,aAAa;AAEnC,aAAS,UAAU;AACV,aAAA;AACP,cAAQ,CAAA;AACR,mBAAa,YAAY;AACzB,mBAAa,WAAW;AAAA,IAC1B;AACO,WAAA;AAAA,EACT;AAAA,EAGA,MAAM,2BAA2B,iBAAiB;AAAA,IAAlD;AAAA;AACU,6CAGH,CAAA;AAAA;AAAA,IAEL,QAAQ,QAAc,SAAsC;AAC1D,WAAK,gBAAgB,KAAK,EAAE,QAAQ,QAAS,CAAA;AAEtC,aAAA,MAAM,QAAQ,QAAQ,OAAO;AAAA,IACtC;AAAA,IAEA,UAAU,QAAoB;AACtB,YAAA,qBAAqB,KAAK,gBAAgB;AAAA,QAC9C,CAAC,OAAO,GAAG,WAAW;AAAA,MAAA;AAExB,WAAK,kBAAkB;AACvB,WAAK,WAAW;AACG,yBAAA,QAAQ,CAAC,OAAO;AACjC,aAAK,QAAQ,GAAG,QAAQ,GAAG,OAAO;AAAA,MAAA,CACnC;AAAA,IACH;AAAA,EACF;AC/JO,WAAS,UAAa,OAA0B;AACrD,QAAI,UAAU;AACd,QAAI,WAAW;AACX,QAAA;AACJ,QAAI,kBAAkB,MAAM;AAAA,IAAA;AACxB,QAAA;AAEJ,aAAS,QAAQ;AACT,YAAA,MAAM,MAAM;AACd,UAAA,WAAW,CAAC,IAAI,MAAM;AAAG;AAClB,iBAAA;AACD,gBAAA;AACV,oBAAc,QAAQ;AACJ,wBAAA,gBAAgB,IAAI,iBAAiB,MAAM;AAC3C,wBAAA,MAAM,SAAS,GAAG;AAAA,IACtC;AACA,aAAS,UAAU;;AACC;AACF;AAChB,kBAAM,YAAN;AACU,gBAAA;AACV,oBAAc,QAAQ;AAAA,IACxB;AACA,aAAS,SAAS;AACR;AACG,iBAAA,YAAY,OAAO,GAAI;AAAA,IACpC;AAEI,QAAA;AAEG,WAAA;AAAA,MACL,WAAW;AACF;AACP,kBAAU,WAAW,MAAM;AACzB,uBAAa,OAAO;AACpB,cAAI,CAAC,UAAU;AACb,0BAAc,QAAQ;AAAA,UACxB;AAAA,QAAA,GACC,MAAO,KAAK,CAAC;AAAA,MAClB;AAAA,MACA,UAAU;AACA;AACR,qBAAa,OAAO;AACpB,sBAAc,QAAQ;AAAA,MACxB;AAAA,IAAA;AAAA,EAEJ;ACzDO,WAAS,kBAAkB;;AAC1B,UAAA,aAAa,SAAS,cAAc,aAAa;AACvD,QAAI,CAAC,YAAY;AACP,cAAA,IAAI,sCAAsC,aAAa;AACxD,aAAA;AAAA,IACT;AAMA,UAAM,QAAQ;AAAA,MACZ,QAAQ;AAAA,MACR,iBAAiB;AAAA,MACjB,qBAAqB;AAAA,MACrB,oBAAoB;AAAA,MACpB,YAAY;AAAA,MACZ,UAAU;AAAA,IAAA;AAEZ,UAAM,cAAc;AAAA,MAClB,cAAc;AAAA,IAAA;AAGV,UAAA,OAAO,GAAG,aAAa;AAC7B,UAAM,QAAQ,MAAM,KAAK,WAAW,iBAAiB,UAAU,CAAC;AAEhE,aAAS,gBACPC,QACA;AACA,aAAOA,OAAM;AAAA,QACX,CAAC,KAAK,QAAQ,IAAI,OAAO,IAAI,KAAK,GAAG,CAAC;AAAA,QAC5B,CAAC;AAAA,MAAA;AAAA,IAEf;AACS,aAAA,eAAe,MAAe,OAAe;AACpD,YAAM,SAAS,MAAM,KAAK,KAAK,QAAQ,EACpC,MAAM,KAAK,EACX,IAAI,CAAC,MAAM,MAAM,KAAK,EAAE,SAAS,CAAC;AAC9B,aAAA,OAAO,OAAO,QAAQ,EAAE,UAAU,OAAO,UAAU,QAAQ,GAAA,CAAI;AAAA,IACxE;AAEA;AAAQ,iBAAW,QAAQ,OAAO;AAChC,cAAM,OAAO,KAAK;AAClB,YAAI,CAAC;AAAM;AACX,YAAI,UAAU;AAEd,aAAI,gBAAK,MAAM,wBAAwB,MAAnC,mBAAsC,WAAtC,mBAA8C,QAAQ;AACpD,cAAA,MAAM,UAAU,MAAM;AAAoB;AAExC,gBAAA,UAAU,eAAe,MAAM,EAAE;AACvC,cAAI,CAAC,QAAQ;AAAU;AACvB,gBAAM,CAAC,cAAc,KAAK,KAAK,IAAI,QAAQ;AAC3C,cAAI,iBAAiB;AAAO;AAE5B,gBAAM,SAAS;AAAA;AAAA,YAEb,MAAM,2BAA2B,YAAY,KAAK,GAAG,KAAK,YAAY;AAAA,YACtE,OAAO,IAAI,YAAY,KAAK,GAAG;AAAA,UAAA;AAEjC,gBAAM,qBAAqB;AAAA;AAAA,YAEzB,MAAM,KAAK,YAAY;AAAA,YACvB,OAAO,IAAI,YAAY;AAAA,UAAA;AAGf,oBAAA;AAAA,QAAA,YAEV,gBAAK,MAAM,iCAAiC,MAA5C,mBAA+C,WAA/C,mBAAuD,cACvD;AACA,cAAI,MAAM;AAAiB;AAErB,gBAAA,UAAU,eAAe,MAAM,EAAE;AACvC,cAAI,CAAC,QAAQ;AAAU;AAEvB,gBAAM,CAAC,OAAO,cAAc,QAAQ,SAAS,IAAI,gBAAgB,OAAO;AAClE,gBAAA,WAAW,IAAI,KAAK,KAAK,YAAY,KAAK,KAAK,KAAK,SAAS;AAEnE,gBAAM,kBAAkB;AAAA;AAAA,YAEtB,MAAM,QAAQ,QAAQ;AAAA,YACtB,OAAO;AAAA,UAAA;AAGC,oBAAA;AAAA,QAAA,YAEV,gBAAK,MAAM,iCAAiC,MAA5C,mBAA+C,WAA/C,mBAAuD,kBACvD;AACA,cAAI,MAAM;AAAqB;AAEzB,gBAAA,UAAU,eAAe,MAAM,EAAE;AACvC,cAAI,CAAC,QAAQ;AAAU;AAEjB,gBAAA,CAAC,QAAQ,YAAY,OAAO,OAAO,QAAQ,SAAQ,YAAY,IAAI,gBAAgB,OAAO;AAChG,gBAAM,WAAW,IAAI,MAAM,KAAK,UAAU,KAAK,KAAK,KAAK,KAAK,KAAK,MAAM,KAAK,OAAO,KAAK,YAAY;AAEtG,gBAAM,sBAAsB;AAAA;AAAA,YAE1B,MAAM,QAAQ,QAAQ;AAAA,YACtB,OAAO;AAAA,UAAA;AAGC,oBAAA;AAAA,QAAA,YACD,gBAAK,MAAM,2BAA2B,MAAtC,mBAAyC,WAAzC,mBAAiD,cAAc;AAExE,cAAI,YAAY;AAAc;AAE9B,gBAAM,QAAQ,MAAM,KAAK,KAAK,QAAQ;AACtC,gBAAM,QAAQ;AACd;AAAc,qBAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AAC7C,oBAAA,QAAQ,MAAM,CAAC;AAErB,oBAAM,WAAU,WAAM,gBAAN,mBAAmB,MAAM;AACzC,oBAAM,QAAO,iBAAM,IAAI,CAAC,MAAX,mBAAc,gBAAd,mBAA2B,MAAM;AAC1C,mBAAA,mCAAU,GAAG,WAAU,KAAK,QAAQ,CAAC,OAAM,6BAAO,KAAI;AACxD,sBAAM,aAAa,MAAM,KAAK,MAAM,SAAS,EAAE,KAAK,GAAG;AACjD,sBAAA,WAAW,MAAM,KAAK,MAAM,IAAI,CAAC,EAAE,SAAS,EAAE,KAAK,GAAG;AAGhD,4BAAA,eAAe,IAAI,UAAU,UAAU,QAAQ,OAAO,UAAU,KAAK,QAAQ;AAAA;AAAA;AAGzF,sBAAM,aAAa;AAAA;AAAA,kBAEjB,MAAM,KAAK,UAAU;AAAA,kBACrB,OAAO,IAAI,UAAU;AAAA,gBAAA;AAEvB,sBAAM,WAAW;AAAA;AAAA,kBAEf,MAAM,KAAK,QAAQ;AAAA,kBACnB,OAAO,IAAI,QAAQ;AAAA,gBAAA;AAGX,0BAAA;AACJ,sBAAA;AAAA,cACR;AAAA,YACF;AAAA,QACF;AAGE,YAAA,WACA,OAAO,OAAO,KAAK,EAAE,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,KACrC,OAAO,OAAO,WAAW,EAAE,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,GAC3C;AACM,gBAAA;AAAA,QACR;AAAA,MACF;AAEA,UAAM,aAAa,OAAO,OAAO,KAAK,EAAE;AAAA,MACtC,CAAC,OAAM,uBAAG,SAAQ,EAAE;AAAA,IAAA;AAEtB,QAAI,WAAW,YAAU,WAAM,uBAAN,mBAA0B,QAAO;AAClD,YAAA,UAAU,WAAW,IAAI,CAAC,MAAM,EAAE,KAAK,EAAE,KAAK,GAAG;AACjD,YAAA,WAAW,WAAW,IAAI,CAAC,MAAM,OAAO,EAAE,IAAI,EAAE,KAAK,GAAG;AAC9D,YAAM,WAAW,OAAO,OAAO,WAAW,EACvC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,EACjB,KAAK,IAAI;AACL,aAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAOc,OAAO;AAAA;AAAA;AAAA,KAG3B,QAAQ;AAAA;AAAA;AAAA,KAGR,QAAQ;AAAA,KAEN,QAAQ,UAAU,EAAE,EACpB,WAAW,QAAQ,IAAI;AAAA,IAC5B;AAEO,WAAA;AAAA,EACT;AC7KA,WAAS,eAAe;AAChB,UAAA,YAAY,SAAS,cAAc,cAAc;AACvD,UAAM,OAAO,uCAAW,cAAc,QAAQ,WAAW;AACnD,UAAA,OAAO,6BAAM,cAAc;AAC1B,WAAA,EAAE,MAAM,MAAM;EACvB;AACA,QAAM,kBAAkB,CAAC,WAAA;;AAEvB;AAAA;AAAA,SAAC,kBAAO,iBAAP,gCAAsB,kCAAtB,mBAAqD,SAAS;AAAA;AAAA;AAO1D,WAAS,wBAAwB;AAClC,QAAA;AACE,UAAA,cAAc,aAAa,MAAM;AAEvC,aAAS,SAAS,WAAsB;AAC1B,kBAAA;AACN,YAAA,KAAK,gBAAgB,UAAU,IAAI;AAEzC,gBAAU,KAAK,MAAM,aAAa,KAAK,SAAS;AAChD,YAAM,QAAQ;AACd,gBAAU,KAAK,QAAQ,KAAK,GAAG,KAAK,aAAa,GAAG,KAAK;AACzD,kBAAY,QAAQ,KAAK,gBAAgB,IAAI,EAAE;AAAA,IACjD;AACA,aAAS,WAAW;AAClB,UAAI,CAAC;AAAW;AACN,gBAAA,KAAK,gBAAgB,OAAO;AAC5B,gBAAA,KAAK,MAAM,eAAe,aAAa;AAAA,IACnD;AAEA,UAAM,oBAAoB,wBAAwB;AAAA,MAChD,gBAAgB;AAAA,MAChB,WAAW;AACT,iBAAS,cAAc;AAAA,MACzB;AAAA,MACA,WAAW;AACA;MACX;AAAA,IAAA,CACD;AAED,UAAM,QAAQ,UAAqB;AAAA,MACjC,MAAM;AACJ,cAAM,MAAM;AACL,eAAA;AAAA,UACL,GAAG;AAAA,UACH,iBAAiB,IAAI;AAAA,UACrB,QAAQ;;AACC,mBAAA,CAAC,EAAE,SAAS,UAAS,SAAI,cAAJ,mBAAe,UAAU,KAAK,IAAI;AAAA,UAChE;AAAA,QAAA;AAAA,MAEJ;AAAA,MACA,SAAS,KAAK;AACM,0BAAA,SAAS,IAAI,IAAI;AAAA,MACrC;AAAA,MACA,UAAU;AACR,0BAAkB,QAAQ;AAC1B,oBAAY,QAAQ;AAAA,MACtB;AAAA,IAAA,CACD;AAEM,WAAA;AAAA,EACT;ACnDO,WAAS,2BAA2B;AACzC,aAAS,gBAAgB,EAAE,MAAM,UAAU,KAAK,KAAK,SAAmB;;AAClE,UAAA,CAAC,KAAK,cAAc,QAAQ;AAAG;AAEnC,YAAM,MAAM,KAAK;AACjB,YAAM,UACJ,UAAK,QAAQ,4BAA4B,MAAzC,mBAA4C,aAAa,kBACzD;AAEF,WAAK,SAAS;AAER,YAAA,MAAM,QAAO,gBAAK,UAAL,mBAAY,IAAI,MAAM,WAAtB,mBAA+B,EAAE;AAElD,UAAA,MAAM,GAAG,KACT,IAAI,IAAI,GAAG,MAAM,OAChB,CAAC;AAAA,OAEC,CAAC;AAAA,MAEA,SAAS;AAAA,QACP,oBAAoB,aAAa,GAAG,QAAQ;AAAA,MAAA,IAElD;AACA;AAAA,MACF;AAEI,UAAA,CAAC,OAAO,CAAC,OAAO;AAClB,eAAO,QAAQ,KAAK,YAAY,MAAM,GAAG;AAAA,MAC3C;AAGA,UAAI,MAAM,QAAQ,QAAQ,EAAE,GAAG;AAE/B,YAAM,QAAQ,MAAM,KAAK,GAAG,EACzB,OAAO,CAAC,KAAKC,SAAQ,MAAM,YAAYA,IAAG,OAAO,EAAE,EACnD,MAAM,GAAG,EAAE;AAER,YAAA,OAAO,SAAS,YAAY;AAClC,UAAI,QAAQ,gBAAgB;AAAA,QAC1B,gBAAgB,GAAG;AAAA,MAAA;AAErB,UAAI,CAAC,SAAS,CAAC,gBAAgB,SAAS,KAAK,GAAG;AACtC,gBAAA,SAAS,cAAc,OAAO;AACtC,cAAM,QAAQ,QAAQ;AACtB,wBAAgB,YAAY,KAAK;AAAA,MACnC;AAEA;AAAA,QACE;AAAA,QACA,gBAAgB,KAAK,KAAK,aAAa,QAAQ,KAAK;AAAA,YAC9C,KAAK;AAAA;AAAA,MAAA;AAIN,aAAA;AAAA,IACT;AAEI,QAAA,oCAAoB;AACxB,UAAM,mBAAmB;AAErB,QAAA,mCAAmB;AACvB,UAAM,sBAAsB;AAEnB,aAAA,gBAAgB,MAAmB,KAAc;AACxC,sBAAA;AAAA,QACd;AAAA,QACA,UAAU;AAAA,QACV;AAAA,QACA,KAAK;AAAA,QACL,OAAO;AAAA,MACR,CAAA,KACC,gBAAgB;AAAA,QACd;AAAA,QACA,UAAU;AAAA,QACV;AAAA,QACA,KAAK;AAAA,QACL,OAAO;AAAA,MAAA,CACR;AAAA,IACL;AACA,UAAM,YAAY;AAAA,MAChB,MAAM,MAAM;AACV,wBAAgB,MAAM,IAAI;AAAA,MAC5B;AAAA,MACA,QAAQ,MAAM;AACZ,wBAAgB,MAAM,KAAK;AAAA,MAC7B;AAAA,IAAA;AAGI,UAAA,uCAAuB;AAC7B,UAAM,gBAAgB;AAAA,MACpB,mBAAmB;AAAA,MACnB,MAAM,QAAQ;;AACN,cAAA,YAAW,YAAO,kBAAP,gCAAuB;AACxC,YAAI,CAAC;AAAU;AACf,cAAM,mBAAmB,wBAAwB;AAAA,UAC/C,gBAAgB;AAAA,UAChB,SAAS,UAAU;;AACjB,gBAAI,CAAC;AAAU;AACf,8BAAkB,WAAW;AAC7B,gBAAI,aAAa,mBAAmB;AAC5BC,oBAAAA,aAAWC,MAAA,OAAO,kBAAP,gBAAAA,IAAA,aAAuB;AACxC,kBAAI,CAACD;AAAiB,uBAAA,QAAQ,KAAK,aAAa;AACxC,sBAAA,IAAI,YAAY,SAAS;AACjC,gCAAkB,QAAQA,WAAU;AAAA,gBAClC,WAAW;AAAA,cAAA,CACZ;AAAA,YACH;AAAA,UACF;AAAA,UACA,SAAS,UAAU;AACT,oBAAA,IAAI,YAAY,SAAS;AACjC,8BAAkB,WAAW;AAAA,UAC/B;AAAA,QAAA,CACD;AACD,cAAM,gBAAgB,wBAAwB;AAAA,UAC5C,gBAAgB;AAAA,UAChB,SAAS,OAAO;AACN,oBAAA,IAAI,YAAY,SAAS;AAE9B,4BAAA,iBAAiB,gBAAgB,KAAK,IAAI,EAC1C,QAAQ,CAAC,UAAU,MAAM,OAAQ,CAAA;AAAA,UACtC;AAAA,UACA,SAAS,OAAO;AACN,oBAAA,IAAI,YAAY,SAAS;AAE9B,4BAAA,iBAAiB,gBAAgB,KAAK,IAAI,EAC1C,QAAQ,CAAC,UAAU,MAAM,OAAQ,CAAA;AAAA,UACtC;AAAA,QAAA,CACD;AACK,cAAA,oBAAoB,eAAe,SAAS;AAEjC,+BAAA,IAAI,MAAM,MAAV,mBAAa;AAC9B,yBAAiB,SAAS,MAAM;AAChC,sBAAc,SAAS,MAAM;AAC7B,yBAAiB,IAAI,QAAQ;AAAA,UAC3B,UAAU;AACR,8BAAkB,WAAW;AAC7B,6BAAiB,QAAQ;AACzB,0BAAc,QAAQ;AAAA,UACxB;AAAA,QAAA,CACD;AAAA,MACH;AAAA,MACA,QAAQ,QAAQ;;AACV,YAAA,GAAC,YAAO,kBAAP,gCAAuB;AAAoB;AAE/B,+BAAA,IAAI,MAAM,MAAV,mBAAa;AAC9B,yBAAiB,OAAO,MAAM;AAAA,MAChC;AAAA,IAAA;AAEI,UAAA,wBAAwB,eAAe,aAAa;AAE1D,UAAM,QAAQ,UAAU;AAAA,MACtB,MAAM;;AACJ,cAAM,OAAO,SAAS;AAAA,UACpB;AAAA,QAAA;AAEI,cAAA,SAAS,6BAAM,cAAc;AACnC,cAAM,YAAW,sCAAQ,cAAc,uBAAtB,mBACb;AACG,eAAA;AAAA,UACL,QAAQ;AACC,mBAAA,CAAC,EAAE,QAAQ,UAAU;AAAA,UAC9B;AAAA,UACA,iBAAiB;AAAA,QAAA;AAAA,MAErB;AAAA,MACA,SAAS,KAAK;AAMR,YAAA,0CAA0B;AAC9B,cAAM,wBAAwB,eAAe;AAAA,UAC3C,MAAM,MAAM;AACV,kBAAM,mBAAmB,MAAM;AAAA,cAC7B,KAAK,iBAAiB,mBAAmB;AAAA,YAAA;AAE1B,6BAAA,QAAQ,CAACE,UAAc;AACtC,kBAAI,CAAC,oBAAoB,IAAIA,KAAI,GAAG;AAClC;AACA,8BAAc,MAAMA,KAAI;AACxB,sCAAsB,QAAQA,OAAM;AAAA,kBAClC,WAAW;AAAA,gBAAA,CACZ;AAAA,cAAA,OACI;AACL,oCAAoB,IAAIA,KAAI;AAAA,cAC9B;AAAA,YAAA,CACD;AAAA,UACH;AAAA,UACA,QAAQ,MAAM;AACZ,kBAAM,mBAAmB,MAAM;AAAA,cAC7B,KAAK,iBAAiB,mBAAmB;AAAA,YAAA;AAE1B,6BAAA,QAAQ,CAACA,UAAc;AAClC,kBAAA,oBAAoB,IAAIA,KAAI,GAAG;AACjC;AACA,8BAAc,QAAQA,KAAI;AAC1B,sCAAsB,WAAW;AACjC,oCAAoB,OAAOA,KAAI;AAAA,cACjC;AAAA,YAAA,CACD;AAAA,UACH;AAAA,QAAA,CACD;AACqB,8BAAA,QAAQ,IAAI,iBAAiB;AAAA,UACjD,WAAW;AAAA,UACX,SAAS;AAAA,QAAA,CACV;AACM,eAAA,MAAM,sBAAsB;MACrC;AAAA,MACA,UAAU;AACD,eAAA,OAAO,gBAAgB,EAAE,QAAQ,CAAC,aAAa,SAAS,SAAS;AACxE,yBAAiB,MAAM;AACvB,8BAAsB,WAAW;AACjC,sBAAc,MAAM;AACpB,qBAAa,MAAM;AAEhB,wBAAA,iBAAiB,cAAc,EAC/B,QAAQ,CAAC,UAAU,MAAM,QAAQ;AACpC,wBAAgB,iBAAiB,OAAO,EAAE,QAAQ,CAAC,UAAU;AAC3D,gBAAM,cAAc;AAAA,QAAA,CACrB;AAAA,MACH;AAAA,IAAA,CACD;AAEM,WAAA;AAAA,EACT;AChPA,QAAM,SAAS,sBAAsB;AACrC,QAAM,YAAY,yBAAyB;AAE3C,QAAM,gBAAgB;AAAA,IACpB,WAAW;AACT,aAAO,SAAS;AAChB,gBAAU,SAAS;AAAA,IACrB;AAAA,IACA,UAAU;AACR,aAAO,QAAQ;AACf,gBAAU,QAAQ;AAAA,IACpB;AAAA,EACF;AAGA,MAAI,OAAO,eAAe;AAExB,WAAO,cAAc;EACvB;AAEA,SAAO,gBAAgB;AACvB,gBAAc,SAAS;AAEvB,UAAQ,IAAI,aAAa,aAAa;;"}